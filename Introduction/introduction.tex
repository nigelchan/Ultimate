%%% Thesis Introduction --------------------------------------------------
\chapter{Introduction}
\ifpdf
    \graphicspath{{Introduction/IntroductionFigs/PNG/}{Introduction/IntroductionFigs/PDF/}{Introduction/IntroductionFigs/}}
\else
    \graphicspath{{Introduction/IntroductionFigs/EPS/}{Introduction/IntroductionFigs/}}
\fi

It is common for econometricians to study the relationship between the dynamics of multiple time series. One of the popular approaches is to look at the coefficient of correlation $R^2$ value and perform ordinary regression analysis. However, Granger and Newbold (1974) showed that this might lead to wrong conclusion. Consider the case when $y_t$ and $x_t$ are two independent first order autogressive processes. It is possible to reject the hypothesis of testing regression coefficients are all zero, i.e., there is significant relation between the two series even though there is none. This phenomenon is called spurious regression. Granger (1987) later proposed the concept of cointegration to study long run relationship between multiple series, and he suggested that there might exist a linear combination of multiple integrated time series to be stationary. For instance, for two $I(1)$ processes $y_t$ and $x_t$, they are said to be cointegrated if there exists a constant $\al$ such that $y_t - \al x_t$ is a stationary process. To formally test for existence of cointegration, Engle and Granger (1987) proposed procedures to check whether the residual series is stationary by testing the existence of a unit root.

Since then, cointegration model has been widely used in empirical analysis in various disciplines, including economics, finance and environmental research. In the past few decades, significant developments have been focused on cointegration models with linear structure. Although the linear structure is convenient for practical implementation, it is often too restrictive. In particular, it is common to observe nonlinear responses with some unknown parameters in the context of economics.  A simple example will be the class of Douglas-Cobb function used in production theory of macroeconomics. The function is given by
\bestar
  y_t = a_t k_t^\al l_t^\al
\eestar
where $y_t$ is the total production output, $k_t$ is flow of service from capital, $l_t$ is flow of service from labour and $a_t$ is the technological shifter. To handle with the nonlinearity, it is common to take logarithm transformation such that standard techniques used in linear cointegrating can be applied. However, such method does not apply when the model becomes more complicated. For instance, Arrow et. al. (1961) later proposed a more generalized production function, which is given by
\bestar
	y_t = a_t [\de\, k_t^{-\rho} + (1 - \de) \,  l_t^{-\rho}]^{ - 1 / \rho}
\eestar
for some constants $\de$ and $\rho$. It is easy to see that the (x.x) is not linear in logarithm and hence ordinary linear cointegration model methodologies do not apply. Another example will be the Carbon Kurznets Curve (CKC) used to study the relationship between economic activities and CO$_2$ emission in environmental science. The CKC curve is given by
\bestar
\log (y_{t}) = \al + \gamma t + \beta_1 \log (x_t) + \beta_2 (\log (x_t))^2
\eestar
where $y_t$ is per capita GDP and $x_t$ is the per capita CO$_2$ emissions. Further examples of nonlinear models can be found in \cite{grangerterasvirta1993}, as well as \cite{terasvirtatjostheimgranger2010}.

These examples show that advanced techniques to analyze nonlinear structure of cointegrating models are necessary. These motivate us to consider the following nonlinear cointegrating model
\be
y_t = f(x_t) + u_t, \quad t = 1, ..., n
\ee
where $f$ is a nonlinear function, $x_t$ is a nonstationary time series and $u_t$ is a stochastic error sequence. An important problem immediately arises from the model will be the estimation of nonlinear regression function $f$. There are two popular ways to perform estimation, namely parametric and nonparametric approaches. These two methods are complementary of each other. Parametric method provides the data analysts with insights about the dynamics of the underlying data generating process. However, it is powerful only when the true model or good approximation of it is correctly specified, and therefore practitioners will run into the risk of mis-specification. For nonparametric approach, it is not necessary to impose a specific mathematical structure on $f$ other than some regularity conditions. Also, it is a useful way to suggest new parametric models and to valid the existing ones.

In the area of nonparametric estimation, one popular estimator adopted in the literature is the Nadaraya-Watson estimator
\bestar
  \hat{f}(x) = \frac{\sum_{t = 1}^n y_t K_h(x_t - x)}{\sum_{t = 1}^n K_h(x_t - x)}
\eestar
of the regression function $f$. There are extensive research results in the literature concentrated on the point-wise estimation and inference of the NW estimator $\hat{f}$, that is, for any fixed $x \in R$,
\bestar
\hat{f}(x) \to_P f(x),
\eestar
under different assumptions on $x_t$. For example, when $x_t$ is stationary time series, H\"{a}rdle et al. (1997) provides a comprehensive review of the literature. When $x_t$ is a nonstationary process, Phillips and Park (1998) studied the model in the context of a random walk. Karlsen and Tj\o stheim (2001) assumes $x_t$ is recurrent Markov chains and Wang and Phillips (2009a, 2009b, 2011) worked with partial sum representations of general linear process. 

Although there are fruitful results in establishing consistency of nonparametric estimator of $\hat{f}$ for a particular fixed $x$, results for the uniform convergence of the estimator is scarce. Explicitly,
\bestar
\sup_{x \in \mathcal{X}} | \hat{f}(x) - f(x) | \to_P 0
\eestar
for some $\mathcal{X} \subset R$. Uniform convergence results of $\hat{f}$ are useful in many areas. As an illustration, we will give a few examples. Firstly, it can used to estimate volatility function in a regression model with non-linear nonstationary heteroskedastic (NNH) error processes, which was first proposed in ??????. Consider the model
\bestar
y_t = f(x_t) + \si(x_t) u_t, \quad t = 1, ..., n
\eestar
where $\si$ is the volatility function. This model is a generalization of the nonlinear cointegration model (x.x) by incorporating a time heterogeneity in the error structure. The conventional kernel estimator of $\si$ is given by
\bestar
\hat{\si}^2(x) = \frac{\sum_{t = 1}^n [y_t  - \hat{f}(x_t) ]^2 K_h(x_t - x)}{\sum_{t = 1}^n K_h(x_t - x)}
\eestar
In order to show point-wise consistency, that is, $\hat{\si}(x) \to_P \si(x)$ for each fixed $x$, we split the estimation error in the following way
\begin{align}
&\hat{\si}^2(x) - \si^2(x) \no\\
&=\frac{\sum_{t = 1}^n \si^2(x) (u_t^2 - 1) K_h(x_t - x)}{\sum_{t = 1}^n K_h(x_t - x)} + \frac{\sum_{t = 1}^n [\si^2(x_t) \si^2(x) ] u_t^2 K_h(x_t - x)}{\sum_{t = 1}^n K_h(x_t - x)} \no\\
&+\frac{\sum_{t = 1}^n (f(x_t) - \hat{f}(x_t))^2 K_h(x_t - x)}{\sum_{t = 1}^n K_h(x_t - x)} + \frac{2\sum_{t = 1}^n \si(x_t) u_t (f(x_t) - \hat{f}(x_t))  K_h(x_t - x)}{\sum_{t = 1}^n K_h(x_t - x)} \no\\
&:= I_{1n}(x) + I_{2n}(x) + I_{3n}(x) + I_{4n}(x) \no
\end{align}
The uniform convergence result of $\hat{f}$ can be used to establish the convergence of $I_{3n}(x)$ and $I_{4n}(x)$. Under the assumption that the kernel function has compact support, there exists a $C > 0$ such that $K_h(x_t - x) = 0$ if $|x_t - x| \ge h\,C$. Therefore, this implies that, as $n\to \infty$
\bestar
|I_{3n}(x)| \le C  \sup_{y \in \Omega_\ep} | \hat{f}(y) - f(y)|^2 = o_P(1)
\eestar
for some $\ep > 0$, where $\Omega_\ep = \{y : |y - x | \le \ep, $ where $ x \in R\}$. An extensive exposition of model (x.x) can be found in Wang and Wang (2009). In addition to estimation of volatility function, uniform convergence of $\hat{f}$ can also be applied to the semiparametric least square estimation of the class of single index model. This class includes many popular econometric models such as binary choice models, duration models and censored Tobit models, see, e.g., Ichimura (1993). Consider the simple case which the model is given by
\bestar
y_t = f(x_t^T\beta_0) + u_t, \quad t = 1, ..., n
\eestar
where $x_t$ is a $p \times 1$ vector with nonstationary components and $\beta_0 \in R^p$ is a $p$-dimensional true parameter vector. We denote two objective functions
\bestar
Q_n(\beta) = \sum_{t = 1}^n (y_t - \hat{f}(x_t^T\beta))^2 \quad \mbox{and} \quad \tilde{Q}_n(\beta) = \sum_{t = 1}^n (y_t - f(x_t^T\beta))^2.
\eestar
The semi-parametric least square estimator of the unknown parameter is defined to be $\hat{\beta}_n = \mbox{arg}\min_{\beta} Q_n(\beta)$. As in Ichimura (1993), the establishment of the weak consistency of $\hat{\beta}_n$ involves proving
\bestar
\sup_{\beta} | Q_n(\beta) - \tilde{Q}_n(\beta)| = o_P(1)
\eestar
Under certain regularity conditions, it suffices to show
\begin{align}
\sup_{\beta} | Q_n(\beta) - \tilde{Q}_n(\beta)| &\le \sup_{\beta}n^{-1}\sum_{t = 1}^n \big |(y_t - f(x_t^T\beta))^2 -  (y_t - \hat{f}(x_t^T\beta))^2 \big | \no\\
  &\le \sup_{\beta} n^{-1}\big (  \sum_{t = 1}^n \big [f(x_t^T\beta)  - \hat{f}(x_t^T\beta) \big ]^2 +\sum_{t = 1}^n |u_t||f(x_t^T\beta)  - \hat{f}(x_t^T\beta)|   \big) \no\\
  &\le \sup_{x \in \mathcal{X}} | f(x) - \hat{f}(x)|^2 + o_P(1) = o_P(1), \no
\end{align}
which is a direct consequence of the uniform consistency of nonparametric estimator $\hat{f}$. 

Moreover, the asymptotic distributional theory of $\sup_{x \in \mathcal{X}} |\hat{f}(x) - f(x)|$ can be used to construct the simultaneous confidence band (SCB) for the estimator $\hat{f}$ over the interval $\mathcal{X}$. Explicitly, the limit distribution of $\sup_{x \in \mathcal{X}} |\hat{f}(x) - f(x)|$ is useful to establish the result
\bestar
 P \big \{ | \hat{f}(x) -  f(x) |  \le b_n(x, z) \quad  \mbox{for all}\quad  x \in \mathcal{X} \big \}  \to F(z)
\eestar
where $F(z)$ is certain distribution function. Then the $100 (1 - \al)\%$, $\al \in (0,1)$, simultaneous confidence band for $f$ over $\mathcal{X}$ is given by 
\be
\hat{f}(x) \pm b_n(x, F^{-1}(1 - \al)) 
\ee
See, e.g., Zhao and Wu (2008) for more details. 

Last but not least, the uniform convergence of $\hat{f}$ has application in unit root testing with NNH error process $\ep_t = \si(x_t)u_t$ described in (x.x). The usual Dickey Fuller test statistics involves unknown nuisance parameter $\si$ which is a nonlinear function. This leads to invalid inference on the existence of unit root if ordinary Dickey Fuller procedure is applied. A solution to such problem using the uniform convergence of $\hat{f}$ will be presented in Section x.x of this thesis.

%Making use of the uniform convergence results, I would propose a unit root testing procedure which can handles with such nuisance parameter. The essential idea of my method is replacing the unknown $\si$ with its consistent estimator $\hat{\si}$, and hence valid inference of existence of unit root can be obtained. Such method has several advantages over the unit root test with nonstationary volatility proposed by Cavaliere? and Taylor (2009) and xxx (xxx). More details can be found in Section x.x of this thesis.


Motivated by the important applications to analysis of various econometric models, the present thesis aims to establish uniform convergence with rates for the Nadaraya-Watson estimator $\hat{f}(x)$ with nonstationary regressor $x_t$. The starting point of my development is to show the uniform convergence of two important functionals. To introduce the two functional classes of interest, consider the decomposition of the estimation difference
\begin{align}
	\hat{f}(x)-f(x) &= \frac{\sum_{t=1}^{n}u_{t}K_{h}(x_{t}-x)}{ \sum_{t=1}^{n}K_{h}(x_{t}-x)}+\frac{\sum_{t=1}^{n}\big[f(x_{t})-f(x)\big] \,K_{h}(x_{t}-x)}{\sum_{t=1}^{n}K_{h}(x_{t}-x)} \no\\
&:= \Theta_{1n}(x)+\Theta_{2n}(x).\no
\end{align}
The second term $\Theta_{2n}(x)$ relates to the bias of the estimation and is very easy to handle with. The asymptotics of $\Theta_{1n}(x)$ involves deriving convergence of the ratio of two random variables, i.e.,
\begin{align}
 \sup_{|x| \le \mathcal{X}} |\Theta_{1n}(x)| &\le \frac{\sup_{|x| \le \mathcal{X}}|\sum_{t=1}^{n}u_{t}K_h(x_{t}-x)|}{\inf_{|x| \le \mathcal{X}}\sum_{t=1}^{n}K_h(x_{t}-x)}  =: \frac{\sup_{|x| \le \mathcal{X}}|S_{1n}(x)|}{\inf_{|x| \le \mathcal{X}}|S_{2n}(x)|} \no
\end{align}
The numerator $S_{1n}(x)$ is the sample covariance functional while $S_{2n}(x)$ term is the sample average functional. This thesis will systematically derive the upper and lower bounds of $S_{1n}(x)$ and $S_{2n}(x)$ uniformly in $x$ over a slowly expanding set $\mathcal{X}$. While our framework allows for a wide selection of regressor $x_t$, we focus primarily the case where $x_t$ is nonstationary, and in particular, when $x_t$ is a partial sum of general linear process and Harris recurrent Markov chain.

The content of this thesis is divided into six chapters. This chapter is the introduction. In chapter 2, we concern with establishing the uniform convergence of the sample covariance functional $S_{1n}(x)$. We establish a framework for the uniform convergence of $S_{1n}(x)$ that allows a wide selection of regressor $x_t$. In Chapter 3-4, we investigate the uniform convergence of the sample average functional $S_{1n}(x)$. The main results in chapter 2-4 will be used in chapter 5, where we establish the uniform convergence of the nonparametric estimator $\hat{f}$ of the nonlinear cointegration model (x.x). In chapter 6, we demonstrate the application of our main results to unit root testing with nonstationary volatility. Finally, in chapter 7, we extend our analysis of cointegration model from nonparametric to parametric estimation of the regression function $f$.

Below, we briefly introduce the content of Chapter 2-7 and give a review on the literature. 

Chapter 2 mainly contributes to provide a framework on the uniform consistency of the functional $S_{1n}(x)$ with broad applicability. In earlier research, the uniform convergence of $S_{1n}(x)$ in the situation that the $(u_t, x_t)$ satisfy certain stationary conditions was studied in many articles. \cite{liero}, \cite{peligrad} and \cite{angonze} considered the uniform convergence over a fixed compact set, while \cite{masry}, \cite{bosq} and \cite{fan} gave uniform results over an unbounded set. More recently, \cite{hansen} provided a set of general uniform consistency results, allowing for stationary strong mixing multivariate data with infinite support, kernels with unbounded support and general bandwidth sequences. However, in comparison to the extensive results where the  $x_t$ comes from a stationary time series data, there is little investigation on the uniform convergence of $S_{1n}(x)$ for the $x_t$ being a non-stationary time series. In this regard, \cite{gao3} derived strong and weak consistency results for the case where the $x_t$ is a null-recurrent Markov chain. \cite{wangwang} worked  with partial sum of general linear processes. While the rate of convergence   in \cite{gao3} is sharp,  they impose the independence between $u_t$ and $x_t$.

We will present a general uniform consistency  result for $S_{1n}(x)$ with the independence between the innovation sequence $u_t$ and the regressor series $x_t$ removed. We allow for $u_t$ to be a martingale difference and wide choice of $x_t$. As a framework,  our  assumption on the $x_t$ is only related to the conditional variance of the  martingale, that is, the $S_{2n}(x)$ in (x.x). Our high level condition is quite natural and holds true for many interesting and important examples. For stationary time series, we include linear process, stationary mixing time series and iterated random function.

For nonstationary $x_t$, the high level condition is equivalent to establishing the uniform upper bound for $\sup_{x \in \mathcal{X}} S_{2n}(x)$. Also, as noted in the above preliminary discussions, for the analysis of the Nadaraya-Watson estimator, we need to consider the uniform lower bound for $\inf_{x \in \mathcal{X}} S_{2n}(x)$ as well. In the second part of Chapter 2, we develop both the uniform upper and lower bounds for $S_{2n}(x)$ under a particular nonstationary situation, when the regressor series $x_t$ is a  Harris recurrent Markov chain. The class of Harris recurrent Markov chain is an important class of time series. It includes both stationay and nonstationary data generating process, such as the random walk, parametric threshold autoregressive (TAR) model. Myklebust et al (2012) also pointed out that null recurrent Markov process is a nonlinear generalization of the linear unit root process.

Chapter 3 continues discussing the uniform convergence of the sample average functional $S_{2n}(x)$, under the situation that $x_t$ is a partial sum of linear processes. The general linear process has an essential difference comparing to the null recurrent Markov chain cosidered in Chapter 2, and it is generally more natural to apply for econometric applications. Existing research working on the general linear processes primarily focuses on the point-wise asymptotics of $S_{2n}(x)$. For example, Borodin and Ibragimov (1995), Akonom (1993) and Phillips and Park (1998) investigated the particular situation where $x_{k}$ is a partial sum of i.i.d. random variables. Jeganathan (2004) studied the asymptotic form of similar functionals when $x_{k}$ is a the partial sum of long memory ?? linear processes. Wang and Phillips (2009) improved the above papers by allowing more general conditions on $x_t$.  Wang and Phillips (2011) considered the point-wise asymptotics of the $S_{2n}(x)$ for the so-called zero energy functional.  In Chapter 3, we essentially improve the above point-wise asymptotic results to uniform convergence. It is worth mentioning that, in additional to nonlinear cointegration model, the asymptotics of $S_{2n}(x)$ have many statistical applications, especially in nonparametric estimation, such as the nonlinear autogressive model. See Wang and Phillips (2011, 2012) and the reference therein.


Chapter 4 has a similar goal to Chapter 3, but it establishes the uniform convergence of $S_{2n}(x)$ using a completely different approach. The new proof involves showing that, under certain conditions and a rich probability space, $S_{2n}(x)$ can be approximated by a local time $L_G(s, x)$ of a Gaussian process $G(t)$ over the real line with certain rates.  We can then establish the uniform lower bound for $\inf_{x \in \mathcal X} S_{2n}(x)$ by using some well known properties the local time process. Applying the local time argument, we basically manage to giving the optimal range $\mathcal{X}$ for the $x$ being held, and therefore improve the results presented in Chapter 3.

In Chpater 5, we apply the results established in Chapter 2--4 to establish the uniform convergence of the Nadaraya-Watson estimator of the regression linked function $\hat{f}$ in a nonlinear cointegration model. Applications of the results established in previous chapters lead to wider choice of regressor series $x_t$, sharp rates of convergence and optimal ranges in which the convergence holds. 

In Chapter 6, we discuss an application of the uniform convergence results of $\hat{f}$ to unit root testing with nonstationary volatility. There are increasing interests in the investigation of the Dickey-Fuller test with the time varying error structure, which is  usually referred to as heteroskedasticity. The existing testing algorithms in the literature mostly rely solely on the  dtime series that generates the volatility  and do not  take extra explanatory data series into consideration. In reality, the forces behind conditional heteroskedasticity in volatility is usually driven by another observable variable, and the factor affecting the conditional heteroskedasticity is usually nonstationary. Moreover, although the conditional variance is always non-negative, the explanatory variables in reality will usually take both positive and negative values. These facts motivate the necessities in  modeling the volatility by using a nonlinear transform of nonstationary process. Explicitly, it is practicably useful to investigate  the Dickey-Fuller
 test with  error structure:
\begin{equation} \la{eqn11}
\eta_{n,t} = \si (x_{n,t}) u_{t+1}
\end{equation}
where $\{x_{n,t}\}$ is a observable  non-stationary time series ($I(1)$ process or similar), $\si(\cdot)$ is  a heterogeneity generating
function (HGF) and for a filtration $\mathcal{F}_{n,t}$ to which $x_{n,t}$
is adapted, $\{u_{t+1},\ {\mathcal{F}_{n,t}}\}$ forms a martingale difference. Under such situation, the limiting distribution of the DF statistic involves the HGF $\si$  which is a nuisance parameter. Direct use of standard Dickey-Fuller test critical values (see, e.g., Fuller (1987)) will lead to invalid inference of the existence of unit root.

In Chapter 6, by applying our results on uniform convergence of nonparametric estimators in Chapter 5, we provide a unit root testing procedure that is capable of handling the non-pivotal quantities appeared in the limiting distribution. The highlight of our method is to use  consistent estimators $\hat{\si}_n(\cdot)$ in place of the nuisance parameters $\si(\cdot)$. We show that this new proposed test statistics based on the Nadaraya-Watson kernel estimators of $\si$ converges weakly to the limiting distribution of the DF-test statistics in (\ref{th21.eqn1}). Therefore, valid inference of the existence of unit root can be carried out.

A far more complete list of articles in this regard includes that Kim and Schmidt (1993), Hansen and Rahbek (1998),  Boswijk (2001) and later Ling et. al (2003) considered   the well known GARCH process; Hamori and Tokihisa (1997),  Kim et. al (2002),  Cavaliere (2004b), Cavaliere and Taylor (2008a) and Beare (2008) discussed  the situation that the conditional volatility is modeled as a general deterministic function; Boswijk (2005),  Xu (2008) and  Cavaliere and Taylor (2007b, 2008b, 2009) allowed for the volatility process to be stochastic, proposed a unit root test based on kernel estimate of the conditional volatility process and provided a simulation algorithm involving wild boostrap.


% ----------------Parametric--------------------------
Finally, in Chapter 7, we consider extending our analysis of the cointegration model to parametric estimation. Parametric model is important as it has high forecasting power and could provide empirical researchers with insights about the dynamics of the underlying data generating process. A typical non-linear parametric cointegrating regression model has the form
 \be y_t&=&
f(x_t, \theta_0)+\,  u_t, \quad t=1,...,n\la {intro.eqn1}.
\ee
where  $f:\mathbb{R} \times \mathbb{R}^m \rightarrow \mathbb{R}$ is a known nonlinear function,
$x_t$ and  $u_t$ are regressor and regression errors, and   $\theta_0$ is an $m$-dimensional true parameter vector that lies in the parameter set $\Theta$. With the observed data $\{y_t, x_t\}_{t=1}^n$, which may include non-stationary components, this chapter is concerned with the nonlinear least squares (NLS) estimation of the unknown parameters $\theta\in \Theta$.

 There are extensive results on the parametric nonlinear regression model when $x_t$ is stationary time series. For example, Jennrich (1969), Malinvaud (1970) and Wu (1981). Also, several authors have studied the model when $x_t$ is a nonstationary time series. Particularly, Park and Phillips (2001) (PP henceforth) considered $x_t$ to be an integrated, $I(1)$, process. Chang et. al (2001) introduced additional linear time trend term and stationary regressors into model (\ref{intro.eqn1}). Also see Chang and Park (2003), Park and Chang (2011) and Shi and Phillips (2012). More references can be found in Chapter 7.

Chapter 7 has a similar goal to the previously mentioned papers but offers more general results. Firstly, we establish a general framework for  weak consistency of the NLS estimator $\hat{\theta}_n$, allowing for the $x_t$ to be  a  wider class of nonstationary time series. The set of sufficient conditions are easy to apply to various nonstationary regressors, including partial sum of linear processes and recurrent Markov chains. Furthermore, we  provide a limit distribution for the NLS estimator $\hat{\theta}_n$. Secondly, in addition to the commonly used martingale innovation structure, our model allows for serial dependence in the equilibrium errors $u_t$ and the innovations driving $x_t$. It is important as our model  permits joint determination of $x_t$ and $y_t$, and hence the system is a time series structural model. Under such situation, the weak consistency and limit distribution of the NLS estimator $\hat{\theta}_n$ are also established.


%%% ----------------------------------------------------------------------


% ------------------------------------------------------------
% The application of cointegration model are not limited to business and economics. For instance, in environmental research,

%cointegration models is used to study the   This model is particular related to this thesis as the regressor $x_t$ is GDP, which is commonly agreed that it exhibits nonstationary behavior.
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../thesis"
%%% End: 
